(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[13],{328:function(e,t,n){},368:function(e,t,n){"use strict";n.r(t);var a=n(44),s=n(50),c=n(21),r=n(45),o=n.n(r),i=n(1),l=n.n(i),u=n(23),d=(n(328),n(330)),j=n(372),b=n(14),p=n(151),h=n(329),m=n(150),O=n(149),f=n(49),x=n(152),v=n(24),g=n.n(v),y=n(11),w=n(8),N=n(28),S=n(4),k=l.a.lazy((function(){return n.e(22).then(n.t.bind(null,351,7))})),F=l.a.lazy((function(){return Promise.all([n.e(3),n.e(4),n.e(20)]).then(n.bind(null,171))}));t.default=Object(w.k)((function(){var e=Object(b.b)(),t=Object(w.g)(),n=Object(b.c)((function(e){return e.common})),r=n.dark,l=n.isUserLoggedIn,v=Object(i.useState)({}),C=Object(c.a)(v,2),R=C[0],E=C[1],P=Object(N.useQuery)("userData",Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("/user/fetchUserInfo");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{onSuccess:function(e){var t=e.data;E(t.details)},enabled:Boolean(l)}),I=(P.data,Object(i.useState)([])),U=Object(c.a)(I,2),T=U[0],B=U[1],D=Object(i.useState)(!1),M=Object(c.a)(D,2),_=M[0],q=M[1],A=Object(i.useState)({title:"",category:"Undefined",tags:[],content:""}),z=Object(c.a)(A,2),J=z[0],V=z[1],W=x.c({title:x.e().required("Post title is required."),category:x.e(),tags:x.a(),content:x.e()}),Y=188,H=[10,13],K=[].concat(Object(a.a)(H),[Y]),L=function(e){(e=Object(j.a)(e.text))&&(T.some((function(t){return t.text===e}))||B([].concat(Object(a.a)(T),[{id:e,text:e}])))},Q=function(e){B((function(){return T.filter((function(t,n){return e!==n}))}))},G=Object(i.useCallback)(Object(h.debounce)((function(e){V(Object.assign(J,{content:e}))}),300),[]),X=function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],T.forEach((function(e){n.push(e.id)})),V(Object.assign(J,{title:t.title,category:t.category},{tags:n},{authorId:R._id,authorName:R.name,authorUsername:R.username}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=Object(N.useMutation)((function(e){return g.a.post("/post/create-post?submitType=publish",e)})),$=Object(N.useMutation)((function(e){return g.a.post("/post/create-post?submitType=draft",e)})),ee=function(){var n=Object(s.a)(o.a.mark((function n(a,c){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,X(a);case 2:Z.mutate(J,{onSuccess:function(){var n=Object(s.a)(o.a.mark((function n(a){var s;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(s=a.data).success){n.next=12;break}return c.resetForm(),V({title:"",category:"",tags:[],content:""}),n.t0=e,n.t1=y.SUCCESS,n.next=8,null===s||void 0===s?void 0:s.message;case 8:return n.t2=n.sent,n.t3={type:n.t1,payload:n.t2},(0,n.t0)(n.t3),n.abrupt("return",t.push("/"));case 12:return n.t4=e,n.t5=y.ERROR,n.next=16,null===s||void 0===s?void 0:s.message;case 16:n.t6=n.sent,n.t7={type:n.t5,payload:n.t6},(0,n.t4)(n.t7);case 19:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),onError:function(t){e({type:y.ERROR,payload:t.response.data.message})}});case 3:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),te=function(){var n=Object(s.a)(o.a.mark((function n(a){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,X(a.values);case 2:$.mutate(J,{onSuccess:function(){var n=Object(s.a)(o.a.mark((function n(s){var c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(c=s.data).success){n.next=12;break}return a.resetForm(),V({title:"",category:"",tags:[],content:""}),n.t0=e,n.t1=y.SUCCESS,n.next=8,null===c||void 0===c?void 0:c.message;case 8:return n.t2=n.sent,n.t3={type:n.t1,payload:n.t2},(0,n.t0)(n.t3),n.abrupt("return",t.push("/"));case 12:return n.t4=e,n.t5=y.ERROR,n.next=16,null===c||void 0===c?void 0:c.message;case 16:n.t6=n.sent,n.t7={type:n.t5,payload:n.t6},(0,n.t4)(n.t7);case 19:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),onError:function(t){e({type:y.ERROR,payload:t.response.data.message})}});case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(S.jsx)("div",{className:Object(u.a)("create_post py-4 p-2 p-sm-4",r?"create_post_dark":"create_post_light"),children:Object(S.jsxs)("div",{className:"container",children:[Object(S.jsxs)("div",{className:"row mb-2 align-items-center",children:[Object(S.jsx)("div",{className:"col-8 col-sm-9",children:Object(S.jsx)("h2",{children:_?"Preview mode":"Create a post"})}),Object(S.jsx)("div",{className:"col-4 col-sm-3 preview-btn ",children:Object(S.jsx)("button",{className:"btn btn-sm  ms-auto shadow-none",onClick:function(){return q(!_)},children:_?Object(S.jsxs)(S.Fragment,{children:["Edit ",Object(S.jsx)(O.a,{})]}):Object(S.jsxs)(S.Fragment,{children:[" ","Preview ",Object(S.jsx)(m.a,{})]})})})]}),_?Object(S.jsx)(i.Suspense,{fallback:Object(S.jsx)(f.a,{}),children:Object(S.jsx)(F,{title:J.title,category:J.category,body:J.content,preview:!0})}):Object(S.jsx)(p.d,{initialValues:J,onSubmit:ee,validationSchema:W,children:function(e){return Object(S.jsxs)(p.c,{className:"p-3",onBlur:function(){return X(e.values)},children:[Object(S.jsxs)("div",{className:"mb-3",children:[Object(S.jsx)(p.b,{as:"textarea",onKeyDown:function(e){parseInt(e.target.style.height)>=300||(e.target.style.height="inherit",e.target.style.height="".concat(e.target.scrollHeight,"px"))},name:"title",className:"form-control shadow-none post-title",placeholder:"New post title here"}),Object(S.jsx)("small",{className:"text-danger",children:Object(S.jsx)(p.a,{name:"title"})})]}),Object(S.jsxs)("div",{className:"mb-3 tags-cont",children:[Object(S.jsx)("label",{htmlFor:"post-tags",className:"form-label",children:"Tags"}),Object(S.jsx)(d.WithContext,{tags:T,autofocus:!1,handleAddition:L,handleDelete:Q,delimiters:K,inputFieldPosition:"inline",allowUnique:!1,classNames:{tags:"tags",tag:"tag",tagInput:"tagInput",tagInputField:"tagInputField",remove:"tagRemoveBtn"}})]}),Object(S.jsxs)("div",{className:"mb-3 category-cont",children:[Object(S.jsx)("label",{htmlFor:"category",className:"form-label",children:"Category"}),Object(S.jsxs)(p.b,{as:"select",name:"category",id:"category",className:"form-control shadow-none",children:[Object(S.jsx)("option",{value:"Undefined",children:"Undefined"}),Object(S.jsx)("option",{value:"Crime",children:"Crime"}),Object(S.jsx)("option",{value:"Food",children:"Food"}),Object(S.jsx)("option",{value:"Travel",children:"Travel"}),Object(S.jsx)("option",{value:"Fashion",children:"Fashion"}),Object(S.jsx)("option",{value:"DIY",children:"DIY"}),Object(S.jsx)("option",{value:"Music",children:"Music"}),Object(S.jsx)("option",{value:"Sports",children:"Sports"}),Object(S.jsx)("option",{value:"E-sports",children:"E-sports"}),Object(S.jsx)("option",{value:"Fitness",children:"Fitness"}),Object(S.jsx)("option",{value:"Business",children:"Business"}),Object(S.jsx)("option",{value:"Politics",children:"Politics"}),Object(S.jsx)("option",{value:"Movie",children:"Movie"}),Object(S.jsx)("option",{value:"Science",children:"Science"}),Object(S.jsx)("option",{value:"Technology",children:"Technology"}),Object(S.jsx)("option",{value:"News",children:"News"})]})]}),Object(S.jsxs)("div",{className:"editor-cont mb-3",children:[Object(S.jsx)("label",{htmlFor:"post-body",className:"form-label",children:"Body"}),Object(S.jsx)(i.Suspense,{fallback:Object(S.jsx)(f.a,{}),children:Object(S.jsx)(k,{content:J.content,activeClass:"editor",events:{change:function(e){return G(e.editor.getData())}},config:{removeButtons:"Cut,Copy,Paste,Anchor,Scayt,PasteText,PasteFromWord,About"}})})]}),Object(S.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(S.jsx)("button",{className:"btn btn-secondary shadow-none me-3",onClick:function(){te(e)},type:"button",children:"Save draft"}),Object(S.jsx)("button",{type:"submit",className:"btn btn-primary  shadow-none",disabled:!e.isValid,children:"Post"})]})]})}})]})})}))}}]);
//# sourceMappingURL=13.0885f15f.chunk.js.map